testCommonCode;
    
GPostInvParam.isParallel = 1;
GShowProfileParam.rangeIP = [5200 8200];

% inverse a profile
inId = 121;
traceNum = 110;
inIds = ones(1, traceNum) * inId;
crossIds = 1 : traceNum;


methods = {
    
    struct(...
        'name', 'Seismic (phase shifte 90)', ...
        'type', 'Seismic', ...
        'load', struct(...
            'mode', 'segy', ...
            'fileName', GPostInvParam.postSeisData.segyFileName, ...
            'segyInfo', bsSetFields(GSegyInfo, {'inlineId', 9; 'crossId', 21; 't0', 0; 'isNegative', 1}) ...
        )...
    );...
    
    struct(...
        'name', 'Initial model', ...
        'isSaveMat', 0, ...
        'load', struct(...
            'mode', 'segy', ...
            'fileName', GPostInvParam.initModel.segyFileName, ...
            'segyInfo', bsSetFields(GSegyInfo, {'inlineId', 189; 'crossId', 21; 't0', 0}) ...
        )...
    );...

    struct(...
        'name', 'TV', ...
        'flag', 'TV', ...
        'regParam', 0.05, ...
        'parampkgs', struct('diffOrder', 1), ...
        'options', bsSetFields(seisInvOptions, {'maxIter', 200; 'initRegParam', 0.5}), ...
        'showFiltCoef', 0.4, ...
        'load', struct(...
            'mode', 'off', ...
            'fileName', '' ...
        )...
    ); 

    struct(...
        'name', 'Low Frequency Constraint', ...
        'flag', 'LFC', ...
        'regParam', 0.05, ...
        'parampkgs', [], ...
        'options', bsSetFields(seisInvOptions, {'maxIter', 200;}), ...
        'showFiltCoef', 0.4, ...
        'load', struct(...
            'mode', 'off', ...
            'fileName', '' ...
        )...
    ); 

    
    struct(...
        'name', 'DLSR (K=1 gamma=0)', ...
        'flag', 'DLSR', ...
        'regParam', struct('lambda', 0.1, 'gamma', 0), ...
        'parampkgs', struct('GSparseInvParam', bsSetFields(GSparseInvParam, {'sparsity', 1; 'isSparseRebuild', 1; 'reconstructType', 'simpleAvg'})), ...
        'options', bsSetFields(seisInvOptions, {'maxIter', 5; 'innerIter', 40; 'initRegParam', 0.05}), ...
        'showFiltCoef', 1, ...
        'isSaveSegy', 1, ...
        'isSaveMat', 0, ...
        'load', struct(...
            'mode', 'off', ...
            'fileName', '' ...
        )...
    );
    
    struct(...
        'name', 'DLSR (K=1 gamma=0.4)', ...
        'flag', 'DLSR', ...
        'regParam', struct('lambda', 0.1, 'gamma', 0.4), ...
        'parampkgs', struct('GSparseInvParam', bsSetFields(GSparseInvParam, {'sparsity', 1; 'isSparseRebuild', 1; 'reconstructType', 'simpleAvg'})), ...
        'options', bsSetFields(seisInvOptions, {'maxIter', 5; 'innerIter', 40; 'initRegParam', 0.05}), ...
        'showFiltCoef', 1, ...
        'isSaveSegy', 1, ...
        'isSaveMat', 0, ...
        'load', struct(...
            'mode', 'off', ...
            'fileName', '' ...
        )...
    );
    
    struct(...
        'name', 'DLSR (K=1 gamma=1)', ...
        'flag', 'DLSR', ...
        'regParam', struct('lambda', 0.1, 'gamma', 1), ...
        'parampkgs', struct('GSparseInvParam', bsSetFields(GSparseInvParam, {'sparsity', 1; 'isSparseRebuild', 1; 'reconstructType', 'simpleAvg'})), ...
        'options', bsSetFields(seisInvOptions, {'maxIter', 5; 'innerIter', 20; 'initRegParam', 0.05}), ...
        'showFiltCoef', 1, ...
        'isSaveSegy', 1, ...
        'isSaveMat', 0, ...
        'load', struct(...
            'mode', 'off', ...
            'fileName', '' ...
        )...
    );
    
    
    struct(...
        'name', 'Sparse Impulse', ...
        'isSaveMat', 0, ...
        'load', struct(...
            'mode', 'segy', ...
            'fileName', [basePath, '\inv_result\geoeast_impedance_sparse_impulse_bgp.sgy'], ...
            'segyInfo', bsSetFields(GSegyInfo, {'inlineId', 189; 'crossId', 21; 't0', 780}) ...
        )...
    );...
% %     
    
% %     
    struct(...
        'name', 'Jason', ...
        'isSaveMat', 0, ...
        'load', struct(...
            'mode', 'segy', ...
            'fileName', [basePath, '\inv_result\inverted_impedance_jason_bgp.sgy'], ...
            'segyInfo', bsSetFields(GSegyInfo, {'inlineId', 189; 'crossId', 21; 't0', 750}) ...
        )...
    ); 
};

% perform the inversion process based on given methods
invResults = bsPostInvTrueMultiTraces(GPostInvParam, inIds, crossIds, timeLine, methods);
% show the comparisons of the inversion results of different methods
bsShowInvProfiles(GPostInvParam, GShowProfileParam, invResults, wellLogs);
% set(gcf, 'position', [140         132        1360         654]);
% bsSaveFigure('./pictures', sprintf('inline_%d', inId));
% bsSaveFigure('./pictures_0.5', sprintf('inline_%d_compare', inId));

%%
